# ============================================
# Neo-Mittens Tmux Config
# Host-aware: works on local machines and servers
# ============================================

set-option -sg escape-time 0

# Options to make tmux more pleasant
set -g mouse on
set -g default-terminal "tmux-256color"

set-option -g allow-rename on
set-option -g automatic-rename off

# Create new session with prefix + S
bind S command-prompt -p "New session name:" "new-session -s '%%'"

# Reload config with prefix + r
bind r source-file ~/.config/tmux/tmux.conf \; display "Config reloaded!"

# Paste from clipboard with image support (prefix + P)
# If clipboard contains an image, saves to /tmp/images/ and pastes LLM-friendly reference
bind P run-shell "$HOME/.config/tmux/tmux-paste-image.sh | tmux load-buffer - && tmux paste-buffer"

# ============================================
# HOST-AWARE THEMING
# Obelisk (server): Ember/volcanic theme
# Local machines: Catppuccin Mocha
# ============================================

# Load host-specific theme based on hostname
# Themes are in ~/.config/tmux/themes/
if-shell '[ "$(hostname -s)" = "obelisk" ]' \
    'source-file ~/.config/tmux/themes/obelisk.tmux' \
    'source-file ~/.config/tmux/themes/local.tmux'

# Catppuccin plugin settings (used by local theme)
set -g @catppuccin_flavor "mocha"
set -g @catppuccin_window_status_style "rounded"
set -g @catppuccin-tmux_show_git 0
set -g @catppuccin-tmux_pane_id_style hide 
set -g @catppuccin-tmux_zoom_id_style hide 
set -g @catppuccin-tmux_show_path 1

# Display pane title as window name (set by shell prompt hook)
set -g @catppuccin_window_text "#T"
set -g @catppuccin_window_current_text "#T"

# Status line layout (overridden by obelisk theme on server)
set -g status-right-length 100
set -g status-left-length 100

# ============================================
# PLUGINS (via TPM)
# ============================================

set-environment -g TMUX_PLUGIN_MANAGER_PATH '~/.tmux/plugins'
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'catppuccin/tmux'

# Initialize TPM (must be at the very end)
run -b '~/.tmux/plugins/tpm/tpm'
