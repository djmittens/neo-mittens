# 001-profile-showdown: Which model combination is best for complex C refactoring?
#
# Target: Valkyria (C runtime with GC, AIO, threading)
# Spec:   system-architecture-refactor.md (9 phases, ~1230 lines)
# Machine: redbox (Ryzen 9 9900X, 64GB RAM, RTX 5090)

# ─────────────────────────────────────────────────────────────────────
# TARGET PROJECT
# ─────────────────────────────────────────────────────────────────────

TARGET_REPO="$HOME/src/valkyria"
BASE_REF="networking"
SPEC="system-architecture-refactor.md"

# ─────────────────────────────────────────────────────────────────────
# PROFILES TO TEST
# ─────────────────────────────────────────────────────────────────────
# hybrid:         Opus 4.6 reasoning + Devstral local BUILD (default)
# opus:           All Opus 4.6 (quality ceiling)
# sonnet:         All Sonnet 4.5 (moderate cloud cost)
# opus-sonnet:    Opus 4.6 reasoning + Sonnet 4.5 BUILD
# sonnet-hybrid:  Sonnet 4.5 reasoning + Devstral local BUILD
# devstral:       All Devstral local (zero quota, quality floor)

PROFILES="hybrid opus sonnet opus-sonnet sonnet-hybrid devstral"

# ─────────────────────────────────────────────────────────────────────
# EXPERIMENT PARAMETERS
# ─────────────────────────────────────────────────────────────────────

MAX_ITERATIONS=25
MAX_WALL_TIME=7200
MAX_FAILURES=3

# ─────────────────────────────────────────────────────────────────────
# CORRECTNESS CHECKS (valkyria-specific)
# ─────────────────────────────────────────────────────────────────────

BUILD_CMD="make build"
TEST_CMD="make test"
TEST_TIMEOUT=300

# Phase 0 gate: all old "2" suffixes must be gone from source
GATE_CHECKS="Phase0-OldSymbols|grep -rcE 'heap2_|tlab2_|page2_|stats2_|mark_ctx2_|valk_gc_malloc_' src/ test/ && exit 1 || exit 0"
